{% load staticfiles %}
{% load sekizai_tags %}
{% load i18n %}

{# Separate addtoblocks used so all static stuff only gets rendered once #}
{% addtoblock 'js' %}
<script src="{% static 'cmsplugin_socialschools/js/socialschools.js' %}"></script>
<script src="{% static 'cmsplugin_socialschools/js/lib/underscore-min.js' %}"></script>
<script src="{% static 'cmsplugin_socialschools/js/lib/moment+langs.min.js' %}"></script>
<script src="{% static 'cmsplugin_socialschools/js/lib/load-image.min.js' %}"></script>
<script src="{% static 'cmsplugin_socialschools/js/lib/bootstrap-image-gallery.js' %}"></script>
<script id="post-template" type="text/x-handlebars-template">
    {% include "cms_plugins/socialschools/post.html" %}
</script>
<script id="comment-template" type="text/x-handlebars-template">
    {% include "cms_plugins/socialschools/comment.html" %}
</script>
<script id="photo-template" type="text/x-handlebars-template">
    {% include "cms_plugins/socialschools/photo.html" %}
</script>
<script id="video-template" type="text/x-handlebars-template">
    {% include "cms_plugins/socialschools/video.html" %}
</script>
<script src="{% static 'cmsplugin_socialschools/js/socialschools_cmsplugin.js' %}"></script>
<script type="text/javascript">
    moment.lang('{{LANGUAGE_CODE}}');
</script>
{% endaddtoblock %}

{# modal-gallery is the modal dialog used for the image gallery #}
{% addtoblock 'js' %}
    <div id="modal-gallery" class="modal modal-gallery hide fade" tabindex="-1">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">&times;</a>
            <h3 class="modal-title"></h3>
        </div>
        <div class="modal-body"><div class="modal-image"></div></div>
        <div class="modal-footer">
            <a class="btn btn-primary modal-prev"><i class="icon-arrow-left icon-white"></i>{% trans 'Previous' %}</a>
            <a class="btn btn-primary modal-next">{% trans 'Next' %} <i class="icon-arrow-right icon-white"></i></a>
            <a class="btn modal-play modal-slideshow" data-slideshow="5000"><i class="icon-play"></i> {% trans 'Slideshow' %}</a>
            <a class="btn modal-download" target="_blank"><i class="icon-download"></i> {% trans 'Download' %}</a>
        </div>
    </div>
{% endaddtoblock %}


{% addtoblock 'js' %}
<script type="text/javascript">
(function () {
    var socialschools = new Socialschools('{{ instance.socialschools_url }}');
    var posts = socialschools.getPublicPosts({{ instance.community_id }}, {
        {% if instance.only_descendants %}
            only_descendants: true
        {% else %}
            only_descendants: false
        {% endif %}
        }, function (posts) {
            renderPosts('#cms-instance-{{ instance.id }}', posts)
        });
}());
</script>
{% endaddtoblock %}



<div id="cms-instance-{{ instance.id }}">
    <div class="css-posts-content">
    </div>
    <ul class="pager">
        <li>
            <a class="css-posts-prev-page" href="">{% trans 'Previous' %}</a>
        </li>
        <li>
             <a class="css-posts-next-page" href="">{% trans 'Next' %}</a>
        </li>
    </ul>
</div>
